---
import { Image } from 'astro:assets';
import { getCollection } from 'astro:content';
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import FormattedDate from '../components/FormattedDate.astro';
import Header from '../components/Header.astro';
import EmailCommentBlock from '../components/EmailCommentBlock.astro';
import { SITE_DESCRIPTION, SITE_TITLE } from '../consts';

import heroPortrait from '../assets/home/gareth-winter-home-1.JPG';
import bradImage from '../assets/home/gareth-winter-sir-bradley-wiggins-hour-record.jpg';
import geraintImage from '../assets/home/gareth-winter-geraint-thomas-team-sky.jpg';

const posts = (await getCollection('blog'))
	.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());

const featured = posts[0];
const remaining = posts.slice(1);
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
	</head>
	<body>
		<Header />

		<!-- ─── Hero ──────────────────────────────────────────────────────── -->
		<section class="hero">
			<div class="container">
				<div class="hero-inner">
					<div class="hero-copy">
						<p class="label hero-kicker">Roadbook of Cycling</p>

						<h1 class="hero-headline">
							Performance, craft, and the quiet obsession of getting better.
						</h1>

						<div class="hero-body">
							<p>
								If you care about the details. If you believe progress is earned, not announced.
								If you've ever replayed a ride in your head hours later — you're in the right place.
							</p>
							<p>
								I write from inside the sport. Where training meets equipment.
								Where small changes compound. Where confidence is built through repetition.
							</p>
						</div>

						<div class="hero-actions">
							<a href="/blog" class="btn-primary">Read the writing</a>
							<a href="#contact" class="btn-secondary">Work together</a>
						</div>

						<div class="hero-credentials">
							<p>
								I've spent over a decade inside elite performance environments —
								not observing them, inside them. Former Creative Director at Team Sky,
								working alongside Olympic champions and Grand Tour winners. Contributor to
								systems that delivered gold medals, Tour de France and Giro d'Italia victories.
							</p>
							<p>
								What I learned wasn't about hype. It was about process. Standards.
								Marginal gains that compound into growth.
							</p>
							<p>
								Today I bring that same lens to brands, founders, and creative teams.
								Clarity over noise. Substance over slogans. Work that holds up under pressure.
							</p>
							<p class="hero-signoff">
								Cyclist. Creative Director. Student of marginal gains.
							</p>
						</div>
					</div>

					<div class="hero-portrait">
						<Image
							src={heroPortrait}
							alt="Gareth Winter"
							width={900}
							height={1200}
							loading="eager"
						/>
						<p class="hero-caption label">Real-world training. Real-world constraints. Real-world obsession.</p>
					</div>
				</div>

				<!-- Gallery — context and authority -->
				<div class="hero-gallery">
					<div class="gallery-img">
						<Image
							src={bradImage}
							alt="Gareth Winter with Sir Bradley Wiggins during the Hour Record project"
							width={1200}
							height={800}
							loading="lazy"
						/>
					</div>
					<div class="gallery-img">
						<Image
							src={geraintImage}
							alt="Gareth Winter with Geraint Thomas during the Team Sky era"
							width={1200}
							height={800}
							loading="lazy"
						/>
					</div>
				</div>
				<p class="gallery-caption label">
					Cyclist. Creative Director. Student of marginal gains. Still riding. Still learning. Still refining.
				</p>
			</div>
		</section>

		<hr class="divider section-divider" />

		<!-- ─── Latest writing ────────────────────────────────────────────── -->
		{featured && (
			<section class="featured">
				<div class="container">
					<p class="label section-label">Latest writing</p>
					<a href={`/blog/${featured.id}/`} class="featured-link">
						{featured.data.heroImage && (
							<div class="featured-image">
								<Image
									src={featured.data.heroImage}
									alt={featured.data.title}
									width={1400}
									height={700}
									loading="lazy"
								/>
							</div>
						)}
						<div class="featured-body">
							<h2 class="featured-title">{featured.data.title}</h2>
							<p class="featured-date label">
								<FormattedDate date={featured.data.pubDate} />
							</p>
							{featured.data.description && (
								<p class="featured-desc">{featured.data.description}</p>
							)}
							<span class="read-link">Read &rarr;</span>
						</div>
					</a>
				</div>
			</section>
		)}

		{remaining.length > 0 && (
			<>
				<hr class="divider section-divider" />
				<section class="more-articles">
					<div class="container">
						<p class="label section-label">More</p>
						<ul class="article-grid">
							{remaining.map((post) => (
								<li>
									<a href={`/blog/${post.id}/`} class="article-card">
										{post.data.heroImage && (
											<div class="card-image">
												<Image
													src={post.data.heroImage}
													alt={post.data.title}
													width={800}
													height={500}
												/>
											</div>
										)}
										<div class="card-body">
											<h3 class="card-title">{post.data.title}</h3>
											<p class="card-date label">
												<FormattedDate date={post.data.pubDate} />
											</p>
										</div>
									</a>
								</li>
							))}
						</ul>
					</div>
				</section>
			</>
		)}

		<hr class="divider section-divider" />

		<!-- ─── Contact ───────────────────────────────────────────────────── -->
		<section class="home-contact" id="contact">
			<div class="container">
				<EmailCommentBlock
					action="https://formspree.io/f/xdalabzw"
					title="Home"
					url={Astro.url.toString()}
					heading="Get in touch"
					copy="For questions, partnerships, podcast appearances, or speaking requests, drop me a note and I'll get back to you."
				/>
			</div>
		</section>

		<Footer />
	</body>
</html>

<style>
	/* ─── Hero ───────────────────────────────────────────────────────────── */
	.hero {
		padding: var(--s-9) 0 var(--s-8);
	}

	.hero-inner {
		display: grid;
		grid-template-columns: 1.1fr 0.9fr;
		gap: var(--s-9);
		align-items: start;
		margin-bottom: var(--s-8);
	}

	.hero-kicker {
		margin-bottom: var(--s-4);
	}

	.hero-headline {
		font-family: var(--font-serif);
		font-size: clamp(2rem, 4.5vw, 3.5rem);
		font-weight: 300;
		line-height: 1.1;
		letter-spacing: -0.02em;
		margin: 0 0 var(--s-6);
	}

	.hero-body p {
		font-size: var(--text-lg);
		color: var(--muted);
		line-height: 1.7;
		margin-bottom: var(--s-4);
		max-width: 52ch;
	}

	.hero-actions {
		display: flex;
		gap: var(--s-3);
		align-items: center;
		margin: var(--s-6) 0 var(--s-7);
		flex-wrap: wrap;
	}

	.btn-primary {
		display: inline-block;
		background: var(--ink);
		color: var(--bg);
		font-family: var(--font-sans);
		font-size: var(--text-xs);
		font-weight: 600;
		letter-spacing: 0.1em;
		text-transform: uppercase;
		text-decoration: none;
		padding: 0.85rem 1.5rem;
		transition: opacity 150ms ease;
	}

	.btn-primary:hover { opacity: 0.75; text-decoration: none; }

	.btn-secondary {
		display: inline-block;
		color: var(--ink);
		font-family: var(--font-sans);
		font-size: var(--text-xs);
		font-weight: 600;
		letter-spacing: 0.1em;
		text-transform: uppercase;
		text-decoration: none;
		border-bottom: 1px solid var(--border);
		padding-bottom: 2px;
		transition: border-color 150ms ease, opacity 150ms ease;
	}

	.btn-secondary:hover { border-color: var(--ink); opacity: 0.7; text-decoration: none; }

	.hero-credentials {
		padding-top: var(--s-6);
		border-top: 1px solid var(--border);
		max-width: 52ch;
	}

	.hero-credentials p {
		font-size: var(--text-base);
		color: var(--muted);
		line-height: 1.7;
		margin-bottom: var(--s-4);
	}

	.hero-signoff {
		font-size: var(--text-sm) !important;
		letter-spacing: 0.06em;
		text-transform: uppercase;
		color: var(--subtle) !important;
		margin-top: var(--s-5);
	}

	/* Portrait */
	.hero-portrait {
		position: sticky;
		top: calc(4rem + var(--s-5));
	}

	.hero-portrait img {
		width: 100%;
		height: auto;
		display: block;
	}

	.hero-caption {
		margin-top: var(--s-3);
	}

	/* Gallery */
	.hero-gallery {
		display: grid;
		grid-template-columns: 1fr 1fr;
		gap: var(--s-4);
		margin-bottom: var(--s-3);
	}

	.gallery-img img {
		width: 100%;
		height: auto;
		display: block;
	}

	.gallery-caption {
		margin-bottom: 0;
	}

	/* ─── Section helpers ────────────────────────────────────────────────── */
	.section-divider { margin-top: var(--s-9); }
	.section-label { margin-bottom: var(--s-5); }

	/* ─── Shared read link ───────────────────────────────────────────────── */
	.read-link {
		font-family: var(--font-sans);
		font-size: var(--text-xs);
		font-weight: 600;
		letter-spacing: 0.1em;
		text-transform: uppercase;
		color: var(--ink);
		text-decoration: none;
		border-bottom: 1px solid var(--ink);
		padding-bottom: 2px;
		transition: opacity 150ms ease;
	}

	.read-link:hover { opacity: 0.5; text-decoration: none; }

	/* ─── Featured article ───────────────────────────────────────────────── */
	.featured { padding: var(--s-8) 0; }

	.featured-link {
		display: grid;
		grid-template-columns: 1fr;
		gap: var(--s-6);
		text-decoration: none;
		color: inherit;
	}

	.featured-image {
		width: 100%;
		aspect-ratio: 16 / 9;
		overflow: hidden;
		background: var(--border);
	}

	.featured-image img {
		width: 100%;
		height: 100%;
		object-fit: cover;
		transition: transform 700ms ease;
	}

	.featured-link:hover .featured-image img { transform: scale(1.02); }

	.featured-body { max-width: 640px; }

	.featured-title {
		font-family: var(--font-serif);
		font-size: clamp(1.75rem, 3.5vw, var(--text-3xl));
		font-weight: 400;
		line-height: 1.1;
		margin-bottom: var(--s-3);
		transition: opacity 150ms ease;
	}

	.featured-link:hover .featured-title { opacity: 0.65; }
	.featured-date { margin-bottom: var(--s-4); }

	.featured-desc {
		font-size: var(--text-lg);
		color: var(--muted);
		line-height: 1.65;
		margin-bottom: var(--s-5);
	}

	/* ─── More articles ──────────────────────────────────────────────────── */
	.more-articles { padding: var(--s-8) 0; }

	.article-grid {
		list-style: none;
		margin: 0;
		padding: 0;
		display: grid;
		grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
		gap: var(--s-7);
	}

	.article-card { display: block; text-decoration: none; color: inherit; }

	.card-image {
		width: 100%;
		aspect-ratio: 3 / 2;
		overflow: hidden;
		background: var(--border);
		margin-bottom: var(--s-4);
	}

	.card-image img {
		width: 100%;
		height: 100%;
		object-fit: cover;
		transition: transform 600ms ease;
	}

	.article-card:hover .card-image img { transform: scale(1.03); }

	.card-title {
		font-family: var(--font-serif);
		font-size: var(--text-2xl);
		font-weight: 400;
		line-height: 1.15;
		margin-bottom: var(--s-2);
		transition: opacity 150ms ease;
	}

	.article-card:hover .card-title { opacity: 0.65; }
	.card-date { margin: 0; }

	/* ─── Contact ────────────────────────────────────────────────────────── */
	.home-contact { padding: var(--s-8) 0 var(--s-10); }

	/* ─── Responsive ─────────────────────────────────────────────────────── */
	@media (max-width: 900px) {
		.hero-inner {
			grid-template-columns: 1fr;
			gap: var(--s-7);
		}

		.hero-portrait {
			position: static;
			order: -1;
		}

		.hero-portrait img {
			max-height: 70vw;
			object-fit: cover;
			object-position: center top;
		}

		.hero-gallery {
			grid-template-columns: 1fr;
		}
	}

	@media (max-width: 600px) {
		.hero { padding: var(--s-7) 0 var(--s-6); }

		.article-grid {
			grid-template-columns: 1fr;
		}
	}
</style>
